
<ul id="messages"></ul>


<form action="/" method="POST" id="chatForm" style="background: #fff; padding: 3px; position: fixed; bottom: 0; width: 100%; border-color: #000; border-top-style: solid; border-top-width: 1px;">
    <input type="text" id="txt" autocomplete="off" autofocus="on" placeholder="type message here..." style="border-style: solid; border-width: 1px; padding: 10px; width: 85%; margin-right: .5%;">
    <button style="width: 9%; background: gray; border: none; padding: 10px; margin-left: 2%;">send</button>
</form>


<script   src="https://code.jquery.com/jquery-3.5.1.min.js"   integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="   crossorigin="anonymous"></script>
<script src="../../socket.io/socket.io.js"></script>
<script>
    $(document).ready( () => {
        var url = (document.URL).split("/");
        var userId = url[url.length-2];
        var roomId = url[url.length-1];

        var socket = io.connect('http://localhost:3000', {query: `userroom=${userId}~${roomId}`});
        
        

        $('body').on('click', '#sendMsgBtn', event => {
            event.preventDefault();
            let msg = $('#msg').val();

            let d = new Date().toString();
            let splitTime = d.split('GMT');
            let time = splitTime[0];

            socket.emit('postMsg', {msg: msg, uId: userId, room: roomId});
            
            return false;
        });

        socket.on('new_msg', msg => {
            if (msg.user_id != userId) {
                return;
            }
            //else : someone else sent this message, post msg to left side of screen
        })
        


    })
    

    



</script>