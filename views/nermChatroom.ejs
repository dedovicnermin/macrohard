
<div class="chatroom-group">
    <button onclick="addChatroom()">++++++++</button>
    <ul id= "chatrooms">
        

        <% for( var i = 0; i < userNames.length; i++) { %>
            <li><button onclick= "goToChatroom()" id = <%= chatIDs[i].chat_id%>> <%= userNames[i].name %></button></li>
           
        <% } %>
    </ul>

    
    <ul id="users">
        <% user.forEach(users => { %>
        <li><label><input name="users" type="checkbox" id = "user.<%= users.user_id%>"/><%= users.user_name%></label>
        <% }) %>
     </ul>
     <button onclick="addChatroom()">Add Members</button>
</div>



<script   src="https://code.jquery.com/jquery-3.5.1.min.js"   integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="   crossorigin="anonymous"></script>
<script src="../../socket.io/socket.io.js"></script>
<script type="text/javascript">
    var url = (document.URL).split("/");
    var userID = url[url.length-1];
    var socket = io.connect('http://localhost:3000');

    socket.on(userID, data => {
        location.replace('http://localhost:3000/messages/'+userID+"/"+data);
    });
    
    

    function addChatroom() {
        
        var users = [];
            $.each($("input[name='users']:checked"), function(){
                users.push((($(this).attr('id')).split("."))[1]);
            });
        users.push(userID);
        socket.emit('addChatroom', users.toString());
        
    }
 
    function goToChatroom()
    {
        var chatID = event.srcElement.id;
        location.replace('http://localhost:3000/messages/'+userID+"/"+chatID);
    }

</script>

    
    
