<%- include('partials/singlenav', {userId}) %>

<div id="chatroom-page-title" style="margin: 0 auto">Chatrooms</div>
<div class="chatroom-page">
<div class="room-container">
    <% chatrooms.forEach(chat => { %>
        <div class="chatroom">
            <input type="hidden" value="<%= chat.cId %>">
            <div class="chatroom__header"><p style="margin-left: 1rem;">Members:</p></div>
            <div class="chatroom__members">
                <% chat.members.forEach(member => { %>
                    <div class="chatroom__members--item"><%= member %></div> 
                <% }) %>
            </div>
            <div class="chatroom__btncontainer">
                <a href="http://localhost:3000/messages/<%= userId %>/<%= chat.cId %>" class="btn btn__xlarge" style="border: 2px solid black; ">ENTER CHATROOM</a>
            </div>
                
            
        </div>
   <% }) %> 
</div>
   
</div>

<a href="#" data-popup-target="#addChatroom" class="btn btn__xlarge" id="createChatBtn" style="font-size: 2.5rem; width: 50%; border: 2px solid black;">CREATE CHATROOM</a>




<div class="popup" id="addChatroom">
    <div class="popup__header">
        <div class="popup__header-title">Enter User Emails:</div>
        <button data-close-button class="popup__header-close-button">&times;</button>
    </div>
    <div class="popup__body">
        <form action="/messages/chat/<%= userId %>" method="POST">
            <label for="emailInput">Enter Email: (then click enter)
                <input type="email" placeholder="Enter email..." name="emailInput" style="width: 100%; height: 3.5rem; padding: 1.5rem;" required pattern="\S(.*\S)?" id="emailInput" title="Enter valid email please!">
            </label>

            <label>Selected Emails:</label>
            
        </form>
    </div>
</div>





<div id="overlay"></div>







<script   src="https://code.jquery.com/jquery-3.5.1.min.js"   integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="   crossorigin="anonymous"></script>
<script src="../../socket.io/socket.io.js"></script>
<script src="/js/popup.js"></script>
<script type="text/javascript">
    var url = (document.URL).split("/");
    var userID = url[url.length-1];
    var socket = io.connect('http://localhost:3000');

    // socket.on(userID, data => {
    //     location.replace('http://localhost:3000/messages/'+userID+"/"+data);
    // });
    //backend sends chat
    
    

    // function addChatroom() {
        
    //     var users = [];
    //         $.each($("input[name='users']:checked"), function(){
    //             users.push((($(this).attr('id')).split("."))[1]);
    //         });
    //     users.push(userID);
    //     socket.emit('addChatroom', users.toString());
        
    // }
 
    // function goToChatroom()
    // {
    //     var chatID = event.srcElement.id;
    //     location.replace('http://localhost:3000/messages/'+userID+"/"+chatID);
    // }

</script>

    
    
